<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sunhyeok Jung Javascript Tutorial</title>
    <link href="./resources/css/index.css" type="text/css" rel="stylesheet">
    <script src = "index.js"></script>
</head>
    <body>
        <div class = "calculator">
            <div class = "calculator_display">0</div>
            <div class = "calculator_keys">
                <button class="key--operator" data-action="add">+</button>
                <button class="key--operator" data-action="subtract">-</button>
                <button class="key--operator" data-action="multiply">*</button>
                <button class="key--operator" data-action="divide">%</button>
                <button>7</button>
                <button>8</button>
                <button>9</button>
                <button>4</button>
                <button>5</button>
                <button>6</button>
                <button>1</button>
                <button>2</button>
                <button>3</button>
                <button>0</button>
                <button data-action="decimal">.</button>
                <button data-action="clear">AC</button>
                <button class="key--equal" data-action="calculate">=</button>

            </div>
        </div>   
    </body>
    <script>

        function calculate(firstValue, operator, secondValue) { 
            if (operator == "add"){ 
                return firstValue + secondValue
            }
            else if (operator == "subtract") { 
                return firstValue - secondValue
            }
            else if (operator == "multiply") { 
                return firstValue * secondValue
            }
            else if (operator == "divide") { 
                return firstValue / secondValue
            }
        }
        const calculator = document.querySelector('.calculator');
        const keys = document.querySelector('.calculator_keys');
        const display = document.querySelector('.calculator_display')
        keys.addEventListener('click', e => {
            if (e.target.matches('button')){
                const key = e.target; 
                const action = key.dataset.action ;
                const keyContent = key.textContent
                const displayedNum = display.textContent
                if (!action) { 
                    if (displayedNum == '0' || calculator.dataset.previousKeyType == "calculate") { 
                        display.textContent = keyContent
                    } else { 
                        display.textContent += keyContent
                    }
                } else { 
                    if (action == "add" ||
                        action == "subtract" || 
                        action == "multiply" || 
                        action == "divide") { 
                            key.classList.add('is-depressed')
                            calculator.dataset.firstValue = displayedNum
                            calculator.dataset.previousKeyType = 'operator'
                            calculator.dataset.operator = action
                            display.textContent = '0'
                    }
                    if (action == 'decimal') {
                        display.textcontent += "."
                      }
                    if (action === 'clear') {
                        display.textContent = '0';
                    }
                    
                    if (action === 'calculate') {
                        const firstValue = calculator.dataset.firstValue
                        const operator = calculator.dataset.operator
                        const secondValue = displayedNum
                        calculator.dataset.previousKeyType = "calculate"

                        display.textContent = calculate(firstValue, operator, secondValue)
                    }
                }
            } 
        })
    </script>
</html>